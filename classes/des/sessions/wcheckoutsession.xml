<form name="wCheckOutSession" caption="Source Safe Warning" bk="FFFFFF" fauthor="$Author: Chris Moran$" fdate="$Date: 8 12 03 11:41$" frevision="$Revision: 2$">
<members>
<Integer name="useSessions" />
<Integer name="chosen" />
<Integer name="isClearCase" />
<method name="setup">
<param name="par" type="form" />
<![CDATA[//@cmember setup
//@param form | par |
//@version Andrew Griffin | 26-04-02 12:20 |
//@version Sorina.Grave | 28-02-05 11:02 |
//@i

dialog(par);

String ini = Sys::MakeFullName(Path(),"..\\des.ini");
String isCC = Sys::GetPrivateProfileString("ClearCase","enabled",ini);
isClearCase = isCC.val();
if(isClearCase)
{
    this.setText("Clear Case Warning");
}
else
{
    useSessions = sessions::asession::useSessions;

    if (useSessions)
    {
        aSession sessions[] = &aSession::getActiveSessions();
        idSList.SetList( sessions );
    }

    ShowGroup( "Ses", useSessions );
    ShowGroup( "noSes", !useSessions );

}
ShowGroup("ClearCase",isClearCase);
ShowGroup("SourceSafe",!isClearCase);

FitRecursive();]]>
</method>
<method name="doCheckOut">
<![CDATA[//@cmember doCheckOut
//@version Andrew Griffin | 18-02-02 10:57 |
//@version Sorina.Grave | 28-02-05 11:00 |
//@i

if(isClearCase)
{
    this.Show(0);
    object X = this.GetParent();
    if(X != null && X.HasMethod("doClearCase"))
    {
        X.DoClearCase("ccchkout");
    }
}
else
{
    aSession choice = &idSList.CurrentRow();

    if (choice!=null) chosen = choice.sesId;
                 else chosen = -1;
}
close();]]>
</method>
<method name="doSesMang">
<![CDATA[//@cmember doSesMang
//@version Andrew Griffin | 25-02-02 09:45 |
//@i

::sessions::wSessionEdit::Main( null, this );]]>
</method>
<method name="wSessionClose">
<![CDATA[//@cmember wSessionClose
//@version Andrew Griffin | 25-02-02 10:08 |
//@i wSessionEdit Callback to refresh...

useSessions = sessions::asession::useSessions;

if (useSessions)
{
    aSession sessions[] = &aSession::getActiveSessions();
    idSList.SetList( sessions );
}]]>
</method>
<method name="doHijack">
<![CDATA[//@cmember doHijack
//@version Sorina.Grave | 28-02-05 11:00 |
//@i

this.Show(0);
object X = this.GetParent();
if(X != null && X.HasMethod("doClearCase"))
{
    X.DoClearCase("cchijack");
}
close();]]>
</method>
</members>
<static>
<method name="go">
<param name="par" type="form" />
<![CDATA[//@cmember go
//@param form | par |
//@version Andrew Griffin | 25-02-02 10:27 |
//@version Sorina.Grave | 28-02-05 10:35 |
//@i

wCheckOutSession f = &createInstance();
f.setup( par );

classes::core::globalForm::openModal( f, par );

return f.Chosen;]]>
</method>
</static>
<grid>
<row>
<col />
<col />
</row>
<row>
<col />
<col bpad="8">
<Label text="This file is Read Only..." style="b" />
</col>
</row>
<row>
<col />
<col bpad="8">
<Label text="Please select an option:" groups="ClearCase" />
</col>
</row>
<row>
<col />
<col bpad="8">
<Label text="Do you want to check it out of Source Safe?" groups="noSes,SourceSafe" />
</col>
</row>
<row>
<col />
<col align="WH">
<grid groups="ses">
<row>
<col bpad="8">
<Label text="To check it out of Source Safe, select a session&#13;&#10;from the list below and click Check Out." groups="SourceSafe" />
</col>
</row>
<row>
<col h="128" align="WH">
<ListBox name="idSList" IsList="Y" ondoubleclick="doCheckOut" fixsize="1" groups="SourceSafe">
<row>
<col lpad="4" tpad="4" rpad="4" bpad="4" w="160">
<Label text="Session Name" header="1" style="b" />
</col>
<col lpad="4" tpad="4" rpad="4" bpad="4">
<Label text="Doc No" style="b" />
</col>
</row>
<row>
<col lpad="4" tpad="1" rpad="4" bpad="1">
<Label text="&gt;&gt;" tx="0,0,128" bind="sname" />
</col>
<col lpad="4" tpad="1" rpad="4" bpad="1">
<Label text="&gt;&gt;" tx="0,0,128" bind="docNo" />
</col>
</row>
</ListBox>
</col>
</row>
</grid>
</col>
</row>
<row>
<col />
<col tpad="16" align="W">
<grid>
<row>
<col lpad="12" tpad="3" rpad="12" bpad="6" align="CV" bkimg="classes::resource::standard::button.bmp" imgtile="32">
<Label text="S.Manager" tx="255,255,255" txsel="FFFF00" style="b" onclick="doSesMang" groups="SourceSafe" />
</col>
<col w="8" align="W" />
<col lpad="12" tpad="3" rpad="12" bpad="6" align="CV" bkimg="classes::resource::standard::button.bmp" imgtile="32">
<Label text="Check Out File" tx="255,255,255" txsel="FFFF00" style="b" onclick="doCheckOut" />
</col>
<col w="8" />
<col lpad="12" tpad="3" rpad="12" bpad="6" align="CV" bkimg="classes::resource::standard::button.bmp" imgtile="32">
<Label text="Hijack File" tx="255,255,255" txsel="FFFF00" style="b" onclick="doHijack" groups="ClearCase" />
</col>
<col w="8" />
<col lpad="12" tpad="3" rpad="12" bpad="6" align="CV" bkimg="classes::resource::standard::button.bmp" imgtile="32">
<Label text="Cancel" tx="255,255,255" txsel="FFFF00" style="b" onclick="close" />
</col>
</row>
</grid>
</col>
</row>
</grid>
</form>
