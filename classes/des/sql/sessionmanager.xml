<form name="sessionManager" base="classes::core::srvmethod" fauthor="$Author: Chris Moran $" fdate="$Date: 8 12 03 11:41 $" frevision="$Revision: 2 $">
<members>
<List name="dataSourcesNames" cls="classes::cpicks" />
<List name="dataSourcesCodes" cls="classes::cpicks" />
<String name="selDB" />
<String name="DBName" />
<method name="init">
<![CDATA[//@cmember init
//@version Andrew Griffin | 13-02-02 09:06 |
//@i

// Get Possible Data Sources...

open();

string Sdatasources = classes::core::SrvSQLInfo::GetDataSources();

classes::cpicks rec;

for (int i=0;; i++) {
    string s = Sdatasources.gettoken( i );
    if (!s) break;
    int j = s.indexof( "=" );
    rec.code = s.subString( j+1 );
    rec.desc = s.left( j );
    dataSourcesCodes.AddRow( rec );
    rec.code = i.tostring();
    dataSourcesNames.AddRow( rec );
}]]>
</method>
<method name="doDataSourceChange">
<![CDATA[//@cmember doDataSourceChange
//@version Andrew Griffin | 13-02-02 09:22 |
//@i

// Get Tables...

int num = idDataSource.getText().val();
string user = dataSourcesCodes[num].code;
selDB = dataSourcesCodes[num].desc;
dbname = classes::core::SrvSQLInfo::GetDBName( selDB );

getSessions();]]>
</method>
<method name="getSessions">
<![CDATA[//@cmember getSessions
//@param
//@return
//@version Andrew Griffin | 13-02-02 09:22 |
//@i

object res = &classes::core::global::serverMethod( this );
if (res==null) {
    message( "ERROR: no results returned from server method" );
    return 0;
}

classes::workers::util::ssession all[] = &res.LX;

classes::debug::showObj( all );]]>
</method>
<method name="onRequest">
<param name="ECB" type="outputStream" />
<![CDATA[//@cmember onRequest
//@param outputStream | ECB |
//@version Andrew Griffin | 13-02-02 09:22 |
//@i

Object LX = classes::workers::util::SSession::All;

ECB.WriteXML( "LX", LX );

return 1;]]>
</method>
</members>
<static>
<method name="Main">
<param name="cmd" type="string" />
<![CDATA[//@cmember Main
//@param string | cmd |
//@version Andrew Griffin | 13-02-02 09:06 |
//@i

createInstance().init();]]>
</method>
</static>
<grid>
<row>
<col />
<col />
<col />
</row>
<row>
<col />
<col>
<grid>
<row>
<col rpad="8">
<Label text="Database:" />
</col>
<col w="140" align="X">
<Edit name="idDataSource" combo="2" onChange="doDataSourceChange" pick="dataSourcesNames" />
</col>
</row>
</grid>
</col>
<col />
</row>
<row>
<col />
<col />
<col />
</row>
<row>
<col />
<col />
<col />
</row>
</grid>
</form>
