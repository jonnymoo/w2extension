<form name="cwsectionheader" margin="0" fauthor="$Author: David.s $" fdate="$Date: 8/10/01 15:23 $" frevision="$Revision: 1 $">
<members>
<method name="SetTitle">
<param name="Title" />
<![CDATA[
// Set the title of the form
lblTitle.setText(Title);]]>
</method>
<method name="AddButton">
<param name="ImageFile" />
<param name="CallBack" />
<param name="HelpText" />
<![CDATA[//@version jonathan.w | 04-10-01 12:54 |

// Image class should be of the form :

// classes::resource::standard::dot_red_down.bmp

// Set the image picture and other info
int i = this.ControlCount();

for (int j = 0; j < i; j++)
{
    Object C = this.GetControl(j);
    if (C == Null) break;

    if (C.GetControlAttr("Name").left(3) == "img")
    {
        // Is it visible
        if (C.IsVisible() == 0)
        {
            // Use this one
            C.SetAttr( "img", imagefile );
            C.SetAttr( "param", Callback);
            C.SetAttr( "hlp", HelpText);
            C.SetVisible(1);
            FitRecursive();
            break;
        }
    }
}]]>
</method>
<method name="OnClick">
<param name="con" />
<![CDATA[
// Get the callback
String CallBack = con.GetControlAttr("param");

// Get the parent object
Object Parent = GetParent();
if (Parent == NULL) return;

// Get the control count
int i = Parent.ControlCount();

// Initalise a pointer to the first control - There must be one
Object C = Parent.GetControl(0);

// Now get this control on the parent form
for (int j = 0; j < i; j++)
{
    // Get the next control
    C = Parent.GetControl(j);

    // Is it a component - This object should be
    if (C.IsType("Component"))
    {
        // Get the class name
        String ClassName = C.CompClass();
        int idx1 = ClassName.IndexOf("::", 0, 1);
        int idx2 = idx1;
        while (idx1 >= 0)
        {
            idx2 = idx1;
            idx1 = ClassName.IndexOf("::", idx1+1, 1);
        }
        if (idx2 != -1)
        {
            ClassName = ClassName.Right(ClassName.Length()-idx2-2);
        }

        // Is it of this type ?
        if (ClassName == "cwsectionheader")
        {
            // Is it this control ?
            if (C.lblTitle == lblTitle) break;
        }
    }

}

// Now notify the parent object
if (Parent.HasMethod(CallBack))
{
    Parent.ExecMethod(CallBack, C);
    return;
}

// Broadcast the message to all objects
classes::localgov::util::functions::broadcast(CallBack, C);]]>
</method>
<method name="OnRightClick">
<param name="con" />
<![CDATA[//@version jonathan.w | 04-10-01 12:54 |
// Get the callback
String HelpText = con.GetControlAttr("hlp");

if (HelpText != "")
{
    PopupMenu P;
    P.Add(HelpText);
    String s = P.Track();
    if (s != "") OnClick( con );
}]]>
</method>
</members>
<static />
<grid>
<row>
<col lpad="10" w="12" h="30" bkimg="classes::resource::standard::green_bar_edge_right.bmp" />
<col tpad="4" w="20" h="30" align="W" bkimg="classes::resource::standard::green_bar_edge.bmp">
<Label name="lblTitle" text="Label" tx="255,255,255" shadc="0,0,0" shadt="1" font="Arial" size="11" style="b" />
</col>
<col lpad="2" tpad="4" w="20" h="30" bkimg="classes::resource::standard::green_bar_edge.bmp">
<Image name="img1" text="Image" img="classes::resource::standard::smallbase.bmp" hide="Y" onClick="OnClick" onRightClick="OnRightClick" />
</col>
<col lpad="2" tpad="4" w="20" h="30" bkimg="classes::resource::standard::green_bar_edge.bmp">
<Image name="img2" text="Image" img="classes::resource::standard::smallbase.bmp" hide="Y" onClick="OnClick" onRightClick="OnRightClick" />
</col>
<col lpad="2" tpad="4" w="20" h="30" bkimg="classes::resource::standard::green_bar_edge.bmp">
<Image name="img3" text="Image" img="classes::resource::standard::smallbase.bmp" hide="Y" onClick="OnClick" onRightClick="OnRightClick" />
</col>
<col lpad="2" tpad="4" w="20" h="30" bkimg="classes::resource::standard::green_bar_edge.bmp">
<Image name="img4" text="Image" img="classes::resource::standard::smallbase.bmp" hide="Y" onClick="OnClick" onRightClick="OnRightClick" />
</col>
<col lpad="2" tpad="4" w="20" h="30" bkimg="classes::resource::standard::green_bar_edge.bmp">
<Image name="img5" text="Image" img="classes::resource::standard::smallbase.bmp" hide="Y" onClick="OnClick" onRightClick="OnRightClick" />
</col>
<col lpad="2" tpad="4" w="20" h="30" bkimg="classes::resource::standard::green_bar_edge.bmp">
<Image name="img6" text="Image" img="classes::resource::standard::smallbase.bmp" hide="Y" onClick="OnClick" onRightClick="OnRightClick" />
</col>
<col tpad="5" w="12" h="30" bkimg="classes::resource::standard::green_bar_edge_left.bmp" />
</row>
</grid>
</form>
