<form name="wProgressBar" sizeable="0" toolwindow="1" hidden="1" noactivate="1" topmost="1" fauthor="$Author: Simon.c$" fdate="$Date: 2/08/02 15:37$" frevision="$Revision: 3$">
<members>
<method name="OpenProgressBar">
<param name="Header" type="object" />
<param name="par" type="object" />
<![CDATA[//@cmember OpenProgressBar
//@param object | Header |
//@param object | par |
//@version Jonathan.Muir | 10-01-02 16:46 |
//@version Simon Carroll | 03-04-02 14:06 |
//@version Jonathan.Muir | 07-08-13 14:44 |
//@i
txHeader.SetText(""+Header);
SetText(Header);
if(par!=null)
{
    this.dialog(par);
    this.SetTopMost(0);
}
else
{
    open();
}

SetFocus();

CenterForm();
Show(1);]]>
</method>
<method name="CloseProgressBar">
<![CDATA[//@cmember CloseProgressBar
//@version Jonathan.Muir | 10-01-02 16:06 |
//@i

Close();]]>
</method>
<method name="SetProgressBar">
<param name="Count" type="int" />
<param name="Max" type="int" />
<param name="Unit" type="string" />
<param name="asPercent" type="int" />
<param name="header" type="string" />
<![CDATA[//@cmember SetProgressBar
//@param int | Count | Current Count
//@param int | Max | Maximum Count
//@param string | Unit | [Optional] Unit
//@param int | asPercent | [Optional] Show as a percentage
//@param string | header | [Optional] Change the Header
//@version Jonathan.Muir | 10-01-02 17:16 |
//@version Simon Carroll | 02-08-02 15:37 |
//@i
int lgth = ((double)Count/(double)Max)*221;
string sz;
if (aspercent != null && asPercent)
{
    int perc = ((double)Count/(double)Max)*100;
    sz = ""+perc+"%";
    if(Unit!=NULL) sz+=" ("+Unit+")";
}
else // Show as a percentage
{
    sz = ""+Count+" of "+Max;
    if(Unit!=NULL) sz+=" ("+Unit+")";
}

txProgress.SetText(sz);

if( header != null && header != "")
    txHeader.SetText(header);
Object C = idlab.GetCell();
C.SetW(lgth);
FitRecursive(1);
UpdateWindow();]]>
</method>
</members>
<static />
<grid>
<row>
<col lpad="8" tpad="3" rpad="8" bpad="2">
<Label name="txHeader" text="Progress Bar" />
</col>
</row>
<row>
<col lpad="8" tpad="3" rpad="10" bpad="2" imgtile="7">
<grid>
<row>
<col w="221" h="12" align="W" bkimg="classes::resource::standard::emptybar.bmp" imgtile="7">
<grid>
<row>
<col h="10" bkimg="classes::resource::standard::singlebar.bmp">
<Label name="idlab" />
</col>
</row>
</grid>
</col>
</row>
</grid>
</col>
</row>
<row>
<col lpad="8" tpad="3" rpad="8" bpad="5">
<Label name="txProgress" text="0 of 0" />
</col>
</row>
</grid>
</form>
